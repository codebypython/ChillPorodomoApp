<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="description" content="ChillPomodoro - ·ª®ng d·ª•ng Pomodoro Timer v·ªõi nh·∫°c n·ªÅn v√† video background t√πy ch·ªânh">
    <meta name="theme-color" content="#667eea">
    <title>ChillPomodoro - Focus & Relax</title>
    
    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Inline critical CSS for viewport -->
    <style>
        html, body {
            width: 100%;
            height: 100%;
            height: 100dvh;
            margin: 0;
            padding: 0;
            overscroll-behavior: none;
            -webkit-overflow-scrolling: touch;
        }
        
        #loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            height: 100dvh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 99999;
            transition: opacity 0.5s ease;
        }
        
        #loading.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .loader {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading">
        <div class="loader"></div>
    </div>

    <!-- Background Layers -->
    <div class="background-layers">
        <!-- Video Background -->
        <video id="backgroundVideo" class="background-video" autoplay loop muted playsinline webkit-playsinline="true" x5-video-player-type="h5" x5-video-player-fullscreen="true" preload="auto">
            <source src="" type="video/mp4">
        </video>
        
        <!-- Image Background -->
        <div id="backgroundImage" class="background-image"></div>
        
        <!-- Animated Backgrounds -->
        <div id="floatingShapes" class="background-animation"></div>
    </div>

    <!-- Main App Container -->
    <div id="app" class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <h1 class="app-title">
                    <span class="title-icon">üéØ</span>
                    ChillPomodoro
                </h1>
            </div>
            
            <div class="header-right">
                <!-- Background Dropdown -->
                <div class="header-dropdown">
                    <button id="backgroundDropdownToggle" class="header-btn" title="Ch·ªçn n·ªÅn">
                        <span>üé®</span>
                    </button>
                    <div id="backgroundDropdown" class="dropdown-menu">
                        <div class="dropdown-header">Ch·ªçn Background</div>
                        <div class="dropdown-scroll">
                            <button class="dropdown-item bg-option" data-bg="none">
                                <span class="item-icon">üö´</span>
                                <span class="item-text">Kh√¥ng n·ªÅn</span>
                            </button>
                            <div class="dropdown-divider"></div>
                            <div class="dropdown-section-title">Videos</div>
                            <!-- Will be populated by JS -->
                        </div>
                    </div>
                </div>
                
                <!-- Music Dropdown -->
                <div class="header-dropdown">
                    <button id="musicDropdownToggle" class="header-btn" title="Ch·ªçn nh·∫°c">
                        <span>üéµ</span>
                    </button>
                    <div id="musicDropdown" class="dropdown-menu">
                        <div class="dropdown-header">Ch·ªçn Nh·∫°c N·ªÅn</div>
                        <div class="dropdown-scroll">
                            <!-- Will be populated by JS -->
                        </div>
                    </div>
                </div>
                
                <!-- Music Toggle -->
                <button id="musicToggle" class="header-btn" title="B·∫≠t/t·∫Øt nh·∫°c">
                    <span>üîá</span>
                </button>
                
                <!-- Background Only Mode -->
                <button id="backgroundToggle" class="header-btn" title="Ch·∫ø ƒë·ªô ch·ªâ n·ªÅn">
                    <span>üñºÔ∏è</span>
                </button>
                
                <!-- Theme Toggle -->
                <button id="themeToggle" class="header-btn" title="Chuy·ªÉn theme">
                    <span class="theme-icon">üåô</span>
                </button>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="app-nav">
            <button class="nav-tab active" data-tab="timer">
                <span class="tab-icon">‚è±Ô∏è</span>
                <span class="tab-label">Timer</span>
            </button>
            <button class="nav-tab" data-tab="animations">
                <span class="tab-icon">üé¨</span>
                <span class="tab-label">Animations</span>
            </button>
            <button class="nav-tab" data-tab="sounds">
                <span class="tab-icon">üéµ</span>
                <span class="tab-label">Sounds</span>
            </button>
            <button class="nav-tab" data-tab="presets">
                <span class="tab-icon">üíæ</span>
                <span class="tab-label">Presets</span>
            </button>
            <button class="nav-tab" data-tab="schedules">
                <span class="tab-icon">üìÖ</span>
                <span class="tab-label">Schedules</span>
            </button>
            <button class="nav-tab" data-tab="settings">
                <span class="tab-icon">‚öôÔ∏è</span>
                <span class="tab-label">Settings</span>
            </button>
            <button class="nav-tab" data-tab="stats">
                <span class="tab-icon">üìä</span>
                <span class="tab-label">Stats</span>
            </button>
        </nav>

        <!-- Tab Contents -->
        <main class="app-main">
            <!-- Timer Tab -->
            <div id="timer-tab" class="tab-content active">
                <div class="timer-container">
                    <!-- Timer Circle -->
                    <div class="timer-circle">
                        <svg class="progress-ring" width="300" height="300">
                            <circle class="progress-ring-bg" cx="150" cy="150" r="120" />
                            <circle id="progressCircle" class="progress-ring-fill" cx="150" cy="150" r="120" />
                        </svg>
                        <div class="timer-display">
                            <div id="timeDisplay" class="time-text">25:00</div>
                            <div id="sessionType" class="session-text">L√†m vi·ªác</div>
                            <div class="session-info">
                                <span>Phi√™n </span>
                                <span id="sessionCount">1</span>
                            </div>
                        </div>
                    </div>

                    <!-- Timer Controls -->
                    <div class="timer-controls">
                        <button id="startBtn" class="control-btn primary">
                            <span class="btn-icon">‚ñ∂</span>
                            <span class="btn-text">B·∫Øt ƒë·∫ßu</span>
                        </button>
                        <button id="pauseBtn" class="control-btn warning" style="display: none;">
                            <span class="btn-icon">‚è∏</span>
                            <span class="btn-text">T·∫°m d·ª´ng</span>
                        </button>
                        <button id="resetBtn" class="control-btn secondary">
                            <span class="btn-icon">‚Üª</span>
                            <span class="btn-text">ƒê·∫∑t l·∫°i</span>
                        </button>
                        <button id="skipBtn" class="control-btn info">
                            <span class="btn-icon">‚è≠</span>
                            <span class="btn-text">B·ªè qua</span>
                        </button>
                    </div>

                    <!-- Quick Actions -->
                    <div class="quick-actions">
                        <div class="quick-actions-title">Th·ªùi gian nhanh</div>
                        <div class="quick-actions-grid">
                            <button class="quick-btn" data-action="work" data-time="5">5 ph√∫t</button>
                            <button class="quick-btn" data-action="work" data-time="15">15 ph√∫t</button>
                            <button class="quick-btn" data-action="work" data-time="25">25 ph√∫t</button>
                            <button class="quick-btn" data-action="work" data-time="45">45 ph√∫t</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Animations Tab -->
            <div id="animations-tab" class="tab-content">
                <div class="library-container">
                    <div class="library-header">
                        <h2>Kho Animation</h2>
                        <p class="library-description">Qu·∫£n l√Ω video v√† ·∫£nh background c·ªßa b·∫°n</p>
                    </div>

                    <div class="library-actions">
                        <button id="addAnimationBtn" class="btn-action primary">
                            <span>‚ûï</span> Th√™m Animation
                        </button>
                    </div>

                    <div id="animationsList" class="library-grid">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
            </div>

            <!-- Sounds Tab -->
            <div id="sounds-tab" class="tab-content">
                <div class="library-container">
                    <div class="library-header">
                        <h2>Kho Sound</h2>
                        <p class="library-description">Qu·∫£n l√Ω nh·∫°c n·ªÅn c·ªßa b·∫°n</p>
                    </div>

                    <div class="library-actions">
                        <button id="addSoundBtn" class="btn-action primary">
                            <span>‚ûï</span> Th√™m Sound
                        </button>
                    </div>

                    <div id="soundsList" class="library-grid">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
            </div>

            <!-- Presets Tab -->
            <div id="presets-tab" class="tab-content">
                <div class="library-container">
                    <div class="library-header">
                        <h2>Preset Manager</h2>
                        <p class="library-description">L∆∞u v√† qu·∫£n l√Ω c√°c c·∫•u h√¨nh y√™u th√≠ch</p>
                    </div>

                    <div class="library-actions">
                        <button id="savePresetBtn" class="btn-action primary">
                            <span>üíæ</span> L∆∞u Preset Hi·ªán T·∫°i
                        </button>
                    </div>

                    <div id="presetsList" class="library-grid">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
            </div>

            <!-- Schedules Tab -->
            <div id="schedules-tab" class="tab-content">
                <div class="schedule-container">
                    <div class="schedule-header">
                        <h2>Qu·∫£n L√Ω L·ªãch Tr√¨nh</h2>
                        <p class="schedule-description">T·∫°o v√† qu·∫£n l√Ω l·ªãch h·ªçc, l·ªãch sinh ho·∫°t, l·ªãch t·∫≠p luy·ªán</p>
                    </div>

                    <div class="schedule-types">
                        <button class="schedule-type-btn active" data-type="class">
                            üìö L·ªãch H·ªçc Tr√™n Tr∆∞·ªùng
                        </button>
                        <button class="schedule-type-btn" data-type="life">
                            üè† L·ªãch Sinh Ho·∫°t
                        </button>
                        <button class="schedule-type-btn" data-type="exercise" disabled title="S·∫Øp c√≥">
                            üí™ L·ªãch T·∫≠p Luy·ªán
                        </button>
                    </div>

                    <!-- Class Schedule Actions -->
                    <div id="classScheduleActions" class="schedule-actions">
                        <button id="uploadScheduleBtn" class="btn-action primary">
                            üì§ N·∫°p D·ªØ Li·ªáu L·ªãch
                        </button>
                        <button id="createScheduleBtn" class="btn-action primary" style="display: none;">
                            ‚úÖ T·∫°o L·ªãch
                        </button>
                    </div>

                    <!-- Daily Activity Schedule Actions -->
                    <div id="dailyScheduleActions" class="schedule-actions" style="display: none;">
                        <button id="createDailyScheduleBtn" class="btn-action primary">
                            ‚ûï T·∫°o L·ªãch Sinh Ho·∫°t
                        </button>
                        <button id="viewTodayScheduleBtn" class="btn-action secondary">
                            üìÖ Xem L·ªãch H√¥m Nay
                        </button>
                    </div>

                    <!-- Class Schedule List -->
                    <div id="scheduleList" class="schedule-list">
                        <!-- Danh s√°ch l·ªãch ƒë√£ t·∫°o -->
                    </div>

                    <!-- Daily Activity Schedule List -->
                    <div id="dailyScheduleList" class="schedule-list" style="display: none;">
                        <!-- Danh s√°ch l·ªãch sinh ho·∫°t -->
                    </div>

                    <!-- Class Schedule Table -->
                    <div id="scheduleTableContainer" class="schedule-table-container" style="display: none;">
                        <!-- B·∫£ng l·ªãch tu·∫ßn -->
                    </div>

                    <!-- Daily Activity Schedule Container -->
                    <div id="dailyScheduleContainer" class="daily-schedule-container" style="display: none;">
                        <!-- L·ªãch sinh ho·∫°t -->
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings-tab" class="tab-content">
                <div class="settings-container">
                    <h2>C√†i ƒê·∫∑t</h2>

                    <div class="settings-section">
                        <h3>‚è±Ô∏è Timer</h3>
                        <div class="setting-item">
                            <label>Th·ªùi gian l√†m vi·ªác (ph√∫t)</label>
                            <input type="number" id="workDuration" min="1" max="60" value="25">
                        </div>
                        <div class="setting-item">
                            <label>Th·ªùi gian ngh·ªâ ng·∫Øn (ph√∫t)</label>
                            <input type="number" id="shortBreakDuration" min="1" max="30" value="5">
                        </div>
                        <div class="setting-item">
                            <label>Th·ªùi gian ngh·ªâ d√†i (ph√∫t)</label>
                            <input type="number" id="longBreakDuration" min="1" max="60" value="15">
                        </div>
                        <div class="setting-item">
                            <label>S·ªë phi√™n tr∆∞·ªõc ngh·ªâ d√†i</label>
                            <input type="number" id="longBreakInterval" min="2" max="10" value="4">
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>üéµ √Çm Thanh</h3>
                        <div class="setting-item">
                            <label>
                                <input type="checkbox" id="enableNotifications" checked>
                                B·∫≠t th√¥ng b√°o √¢m thanh
                            </label>
                        </div>
                        <div class="setting-item">
                            <label>√Çm l∆∞·ª£ng th√¥ng b√°o: <span id="volumeDisplay">70%</span></label>
                            <input type="range" id="notificationVolume" min="0" max="100" value="70">
                        </div>
                        <div class="setting-item">
                            <label>
                                <input type="checkbox" id="enableBackgroundMusic">
                                B·∫≠t nh·∫°c n·ªÅn
                            </label>
                        </div>
                        <div class="setting-item">
                            <label>√Çm l∆∞·ª£ng nh·∫°c n·ªÅn: <span id="musicVolumeDisplay">50%</span></label>
                            <input type="range" id="backgroundMusicVolume" min="0" max="100" value="50">
                        </div>
                        <div class="setting-item">
                            <label>√Çm l∆∞·ª£ng t·ª´ng nh·∫°c n·ªÅn ƒë√£ ch·ªçn</label>
                            <div id="perTrackVolumeContainer" class="mt-2"></div>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>üé® Giao Di·ªán</h3>
                        <div class="setting-item">
                            <label>Lo·∫°i background</label>
                            <select id="backgroundType">
                                <option value="none">Kh√¥ng n·ªÅn</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label>ƒê·ªô m·ªù background: <span id="opacityDisplay">80%</span></label>
                            <input type="range" id="backgroundOpacity" min="0" max="100" value="80">
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>üéØ H√†nh Vi</h3>
                        <div class="setting-item">
                            <label>
                                <input type="checkbox" id="autoStartBreaks">
                                T·ª± ƒë·ªông b·∫Øt ƒë·∫ßu ngh·ªâ
                            </label>
                        </div>
                        <div class="setting-item">
                            <label>
                                <input type="checkbox" id="autoStartPomodoros">
                                T·ª± ƒë·ªông b·∫Øt ƒë·∫ßu l√†m vi·ªác
                            </label>
                        </div>
                    </div>

                    <div class="settings-actions">
                        <button id="saveSettings" class="btn-action primary">
                            üíæ L∆∞u C√†i ƒê·∫∑t
                        </button>
                        <button id="resetSettings" class="btn-action secondary">
                            ‚Üª ƒê·∫∑t L·∫°i M·∫∑c ƒê·ªãnh
                        </button>
                    </div>
                </div>
            </div>

            <!-- Stats Tab -->
            <div id="stats-tab" class="tab-content">
                <div class="stats-container">
                    <h2>Th·ªëng K√™</h2>

                    <div class="stats-summary">
                        <div class="stat-card">
                            <div class="stat-icon">üçÖ</div>
                            <div class="stat-value" id="totalPomodoros">0</div>
                            <div class="stat-label">T·ªïng Pomodoros</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">‚è±Ô∏è</div>
                            <div class="stat-value" id="totalWorkTime">0m</div>
                            <div class="stat-label">T·ªïng Th·ªùi Gian</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">‚òï</div>
                            <div class="stat-value" id="totalBreakTime">0m</div>
                            <div class="stat-label">T·ªïng Ngh·ªâ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üî•</div>
                            <div class="stat-value" id="currentStreak">0</div>
                            <div class="stat-label">Chu·ªói Ng√†y</div>
                        </div>
                    </div>

                    <div class="stats-chart">
                        <h3>Ho·∫°t ƒë·ªông 7 ng√†y qua</h3>
                        <canvas id="activityChart" width="800" height="400"></canvas>
                    </div>

                    <div class="stats-actions">
                        <button id="exportBtn" class="btn-action secondary">
                            üì• Export D·ªØ Li·ªáu
                        </button>
                        <button id="clearDataBtn" class="btn-action danger">
                            üóëÔ∏è X√≥a T·∫•t C·∫£
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Background Only Mode Overlay -->
    <div id="backgroundOnlyOverlay" class="background-only-overlay">
        <button id="exitBackgroundMode" class="exit-bg-btn" title="Tho√°t ch·∫ø ƒë·ªô background (ESC)">
            ‚úï
        </button>
    </div>

    <!-- Modal for Add/Edit Items -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Th√™m Animation</h3>
                <button class="modal-close">‚úï</button>
            </div>
            <div class="modal-body">
                <div id="modalForm">
                    <!-- Form will be populated by JS -->
                </div>
            </div>
            <div class="modal-footer">
                <button id="modalCancelBtn" class="btn-action secondary">H·ªßy</button>
                <button id="modalSaveBtn" class="btn-action primary">L∆∞u</button>
            </div>
        </div>
    </div>

    <!-- Schedule Upload Modal -->
    <div id="scheduleUploadModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>N·∫°p D·ªØ Li·ªáu L·ªãch H·ªçc</h3>
                <button class="modal-close" id="closeScheduleUploadModal">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="upload-form">
                    <div class="form-group">
                        <label for="scheduleFileInput">Ch·ªçn file Excel (.xlsx)</label>
                        <input type="file" id="scheduleFileInput" accept=".xlsx,.xls" />
                        <div id="scheduleFileName" class="file-name-display">Ch∆∞a ch·ªçn file</div>
                    </div>
                    <div class="form-group">
                        <label for="scheduleNameInput">T√™n l·ªãch</label>
                        <input type="text" id="scheduleNameInput" placeholder="Nh·∫≠p t√™n l·ªãch (v√≠ d·ª•: L·ªãch h·ªçc HK1 2024)" />
                    </div>
                    <div class="form-hint">
                        <p>üìã <strong>H∆∞·ªõng d·∫´n:</strong></p>
                        <p>File Excel c·∫ßn c√≥ c√°c c·ªôt: TT, M√£ l·ªõp h·ªçc ph·∫ßn, T√™n l·ªõp h·ªçc ph·∫ßn, S·ªë TC, Gi·∫£ng vi√™n, Th·ªùi kh√≥a bi·ªÉu, Tu·∫ßn h·ªçc</p>
                        <p>ƒê·ªãnh d·∫°ng th·ªùi kh√≥a bi·ªÉu: "Th·ª© 4,1-2,E2.403" (Th·ª©, Ti·∫øt, Ph√≤ng)</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelUploadBtn" class="btn-action secondary">H·ªßy</button>
                <button id="confirmUploadBtn" class="btn-action primary">N·∫°p File</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <span id="notificationText"></span>
        <button class="notification-close">‚úï</button>
    </div>

    <!-- Scripts -->
    <!-- Load XLSX library from CDN -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script type="module" src="js/main.js"></script>
</body>
</html>

